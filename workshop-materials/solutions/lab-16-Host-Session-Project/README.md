# Lab 16: Host Session Project Implementation

## Overview
This lab implements Host Session Project infrastructure and configuration in your GCP Landing Zone using Terraform. You will deploy resources to establish secure host session management and project isolation.

## Folder Structure
- `terraform/` – Terraform configuration files (`main.tf`, `variables.tf`, `outputs.tf`, `terraform.tfvars.example`)
- `scripts/` – (Empty, add any helper scripts here)
- `docs/` – (Empty, add any documentation here)

## Configuration Details

### Required terraform.tfvars Changes
Before running Terraform, you must update the following variables in `terraform.tfvars`:

**Essential Configuration:**
- `project_id` - Your main GCP project ID
- `host_project_id` - Project ID for the host session project (can be same as project_id)
- `region` - GCP region (default: us-central1)
- `zone` - GCP zone (default: us-central1-a)

**Project Creation (if needed):**
- `create_host_project` - Set to `true` if creating a new project
- `billing_account` - Your billing account ID (format: 000000-000000-000000)
- `folder_id` - Organization folder ID for the new project

**Network Security:**
- `ssh_source_ranges` - IP ranges allowed for SSH (replace with your corporate networks)
- `rdp_source_ranges` - IP ranges allowed for RDP (replace with your corporate networks)
- `host_session_subnet_cidr` - Subnet CIDR (default: 10.0.0.0/24)

**IAM Configuration:**
- `host_session_admin_members` - List of users/groups with admin access
- `host_session_user_members` - List of users/groups with user access

**Optional Features:**
- `create_sample_vm` - Set to `true` to create a test VM instance
- `sample_vm_service_account_email` - Service account for the VM

## Prerequisites
- Lab 15 completed
- Google Cloud SDK (`gcloud`) installed and authenticated
- Terraform installed
- Bash shell (Ubuntu recommended)
- Valid GCP project and billing enabled

## Steps to Execute

### 1. Prepare Environment
```bash
cd ~/workshop-materials/solutions/lab-16-Host-Session-Project/terraform
cp terraform.tfvars.example terraform.tfvars
# Edit terraform.tfvars with the following required changes:
# 1. Update 'project_id' with your actual GCP project ID
# 2. Set 'host_project_id' with your host session project ID
# 3. Configure 'billing_account' if creating a new project
# 4. Update 'folder_id' if organizing under a specific folder
# 5. Modify 'ssh_source_ranges' and 'rdp_source_ranges' for your network
# 6. Update IAM member lists with actual user/group emails
# 7. Set 'create_sample_vm' to true if you want to deploy a test VM
# 8. Customize network CIDRs if needed (default: 10.0.0.0/24)
```

### 2. Initialize Terraform
```bash
terraform init
```

### 3. Review the Plan
```bash
terraform plan -var-file=terraform.tfvars
```

### 4. Apply the Configuration
```bash
terraform apply -var-file=terraform.tfvars
# Type 'yes' to confirm
```

### 5. Review Outputs
```bash
terraform output
```

## Cleanup
```bash
terraform destroy -var-file=terraform.tfvars
# Type 'yes' to confirm
```

## Resources Created
- Host session project infrastructure
- Session management resources
- Project isolation configurations
- Security and access controls

## Notes
- Generated by Copilot
- Ensure proper IAM permissions are configured before execution
- Review and customize variables according to your environment
- Monitor resource usage and costs

## Troubleshooting
- Verify GCP authentication: `gcloud auth list`
- Check project permissions: `gcloud projects get-iam-policy PROJECT_ID`
- Validate Terraform configuration: `terraform validate`
